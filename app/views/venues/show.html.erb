<%
  set_meta_tags(
    title: "Venue | #{@venue.name}. View ratings, details, search for venues on our map. Submit a parma rating for this venue",
    description: "View all details for this venue. Ratings, address, contact details & website. Search for a venue on our map. Submit a rating for this venue.",
    keywords: "Parma, Venue, Rate, Search, Map"
  )
%>
<div class="flex flex-col flex-grow w-full lg:w-11/12 h-full lg:h-screen" data-controller="venue-details">
  <turbo-frame id="venue-details" data-turbo-action="replace" data-turbo="false" class="flex flex-col lg:flex-row h-full">
    <div class="min-h-[70%] lg:h-full flex flex-col lg:w-full font-['Open_Sans'] text-saffron-mango-900 lg:mx-3" style="background-image: url(<%= image_path "parma-trans.png" %>);background-repeat:no-repeat;background-size:cover 80%;">
      <div class="px-2 md:px-4 py-2 md:py-4 whitespace-nowrap lg:whitespace-normal" data-controller="text-shrink">
        <h1 class="text-2xl sm:text-4xl font-semibold" data-text-shrink-target="text"><%= @venue.name %></h1>
        <div class="w-1/4 md:w-1/3 h-1 py-1 md:py-2.5 ml-2 border-b-2 border-saffron-mango-950"></div>
      </div>
      <div class="flex justify-between mx-4 md:mx-8 lg:my-4">
        <div class="flex flex-col justify-between my-2 md:my-3" data-venue-details-target="buttonsDiv">
          <form>
            <select id="countries" class="custom-select !text-sm md:!text-base lg:!text-lg w-[6rem] md:w-[10rem] transition ease-in-out duration-300 bg-saffron-mango-300 text-saffron-mango-700 hover:bg-saffron-mango-500 font-semibold hover:text-saffron-mango-100 py-1 md:py-2 px-1.5 md:px-3 mr-1 md:mr-4 border border-saffron-mango-600 focus:border-saffron-mango-800 hover:border-transparent rounded", data-action="change->venue-details#handleSelect">
              <option value="ratings" class="!text-sm md:!text-base lg:!text-lg">Ratings</option>
              <option value="details" class="!text-sm md:!text-base lg:!text-lg">Details</option>
            </select>
          </form>
        </div>
        <div data-venue-details-target="ratingsDiv">
          <ul class="flex flex-col items-end text-xl md:text-3xl lg:mt-16">
            <li class="flex justify-end items-center border-b border-saffron-mango-950 w-48 pb-2 md:pb-4 lg:pb-4 [@media(max-height:700px)]:pb-1">
              <h3 class="font-bold">MEAT</h3>
              <%= image_tag "google-star-24px.svg", alt: "Rating star", class: "md:hidden ml-2 mr-5" %>
              <%= image_tag "google-star-30px.svg", alt: "Rating star", class: "hidden md:block lg:hidden ml-2 mr-5" %>
              <%= image_tag "google-star-36px.svg", alt: "Rating star", class: "hidden lg:block ml-2 mr-5" %>
              <h3><%= @venue.chicken_rating_average %></h3>
            </li>
            <li class="flex justify-end items-center border-b border-saffron-mango-950 w-48 py-1.5 md:py-2 lg:py-4 [@media(max-height:700px)]:py-1">
              <h3 class="font-bold">CRUMB</h3>
              <%= image_tag "google-star-24px.svg", alt: "Rating star", class: "md:hidden ml-2 mr-5" %>
              <%= image_tag "google-star-30px.svg", alt: "Rating star", class: "hidden md:block lg:hidden ml-2 mr-5" %>
              <%= image_tag "google-star-36px.svg", alt: "Rating star", class: "hidden lg:block ml-2 mr-5" %>
              <h3><%= @venue.crumb_rating_average %></h3>
            </li>
            <li class="flex justify-end items-center border-b border-saffron-mango-950 w-48 py-1.5 md:py-2 lg:py-4 [@media(max-height:700px)]:py-1">
              <h3 class="font-bold">TOPPING</h3>
              <%= image_tag "google-star-24px.svg", alt: "Rating star", class: "md:hidden ml-2 mr-5" %>
              <%= image_tag "google-star-30px.svg", alt: "Rating star", class: "hidden md:block lg:hidden ml-2 mr-5" %>
              <%= image_tag "google-star-36px.svg", alt: "Rating star", class: "hidden lg:block ml-2 mr-5" %>
              <h3><%= @venue.topping_rating_average %></h3>
            </li>
            <li class="flex justify-end items-center border-b border-saffron-mango-950 w-48 py-1.5 md:py-2 lg:py-4 [@media(max-height:700px)]:py-1">
              <h3 class="font-bold">SIDES</h3>
              <%= image_tag "google-star-24px.svg", alt: "Rating star", class: "md:hidden ml-2 mr-5" %>
              <%= image_tag "google-star-30px.svg", alt: "Rating star", class: "hidden md:block lg:hidden ml-2 mr-5" %>
              <%= image_tag "google-star-36px.svg", alt: "Rating star", class: "hidden lg:block ml-2 mr-5" %>
              <h3><%= @venue.sides_rating_average %></h3>
            </li>
            <li class="flex justify-end items-center border-b border-saffron-mango-950 w-48 py-1.5 md:py-2 lg:py-4 [@media(max-height:700px)]:py-1">
              <h3 class="font-bold">VENUE</h3>
              <%= image_tag "google-star-24px.svg", alt: "Rating star", class: "md:hidden ml-2 mr-5" %>
              <%= image_tag "google-star-30px.svg", alt: "Rating star", class: "hidden md:block lg:hidden ml-2 mr-5" %>
              <%= image_tag "google-star-36px.svg", alt: "Rating star", class: "hidden lg:block ml-2 mr-5" %>
              <h3><%= @venue.venue_rating_average %></h3>
            </li>
            <li class="flex justify-end items-center w-48 pt-2 md:pt-2 lg:pt-4 [@media(max-height:700px)]:pt-1">
              <h3 class="font-bold mr-6">PRICE</h3>
              <h3>$<%= number_with_precision @venue.price_average.round(1), :precision => 2 %></h3>
            </li>
          </ul>
        </div>
        <div class="hidden" data-venue-details-target="detailsDiv">
          <div class="flex flex-col h-full text-saffron-mango-900 py-2 lg:mt-16 sm:text-2xl lg:text-2xl">
            <p class="text-right"><%= @venue.address %></p>
            <p class="text-right"><%= @venue.phone %></p>
            <%= link_to "Venue website", @venue.website, class: "transition ease-in-out duration-300 text-saffron-mango-800 hover:text-saffron-mango-950 text-right underline" %>
            <h4 class="mt-3 text-right">Venue opening hours</h4>
            <% if @venue.hours %>
              <% JSON.parse(@venue.hours).each do |hours| %>
                <p class="text-right"><%= hours %></p>
              <% end %>
            <% else %>
              <p class="text-right">Not provided</p>
            <% end %>
          </div>
        </div>
      </div>
      <div class="mt-auto">
        <div data-venue-details-target="totalsDiv">
          <div class="flex justify-between items-center text-xl md:text-3xl border-y border-saffron-mango-950 px-4 py-1.5 md:py-2 lg:py-3 [@media(max-height:700px)]:py-1 my-2 md:my-3 lg:my-4 [@media(max-height:760px)]:my-1">
            <div class="flex justify-between items-center">
              <p>
                <h3 class="font-bold">TOTAL RATING</h3>
                <%= image_tag "google-star-24px.svg", alt: "Rating star", class: "md:hidden ml-2 mr-2" %>
                <%= image_tag "google-star-30px.svg", alt: "Rating star", class: "hidden md:block lg:hidden ml-2 mr-2" %>
                <%= image_tag "google-star-36px.svg", alt: "Rating star", class: "hidden lg:block ml-2 mr-2" %>
                <h3><%= @venue.total_rating_average %></h3>
              </p>
            </div>
            <div>
              <h3>Rated <%= @venue.ratings.count %> times</h3>
            </div>
          </div>
        </div>
        <div data-venue-details-target="formButton">
          <div class="flex justify-end pt-1 pb-3 sm:pb-5 lg:pb-6">
            <%= link_to "Rate venue's Parma", new_venue_rating_path(@venue), class: "transition ease-in-out duration-300 bg-transparent hover:bg-saffron-mango-600 text-saffron-mango-700 text-base md:text-xl font-semibold hover:text-white py-1 md:py-2 px-1.5 md:px-3 mr-2 border border-saffron-mango-600 hover:border-transparent rounded" %>
          </div>
        </div>
      </div>
    </div>
    <div class="w-full lg:w-2/3 h-full flex flex-col relative shadow-[0px_0px_10px_rgba(0,0,0,0.1)]"
      data-controller="google-maps"
      data-venue-details-target="mapDiv"
      data-google-maps-page-value="venue"
      data-google-maps-lat-value="<%= @venue.latitude %>"
      data-google-maps-lng-value="<%= @venue.longitude %>"
      data-google-maps-initial-load-value="true"
      data-google-maps-marker-clicked-value="false">
      <%= render "shared/map" %>
    </div>
  </turbo-frame>
</div>
